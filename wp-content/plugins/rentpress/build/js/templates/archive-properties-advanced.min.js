var rent_range=scriptVars.rent_range,taxonomies=scriptVars.taxonomies,properties=scriptVars.properties,rentpress_plugin_assets=scriptVars.rentpress_plugin_assets,property_load_limit=scriptVars.property_load_limit,rentpress_options=scriptVars.rentPress_options,accentColor=scriptVars.accentColor,clusterGridSize=scriptVars.clusterGridSize,minClusterSize=scriptVars.minClusterSize,selected_price_min=0,selected_price_max=0,selectedSqftMin=0,selectedSqftMax=0,searchTerm="",maxSqft="",minSqft="",showAllProps=!1,filterCount=0,showAllButton=document.getElementById("rp-prop-load-more-btn"),selectedFilters={size:[],pet:[],type:[]},propertiesInMap=[];params=new URLSearchParams(location.search);var maxRent=params.getAll("max_price"),beds=params.getAll("beds"),pets=params.getAll("pets"),types=params.getAll("types"),term=params.getAll("search"),minSize=params.getAll("min_sqft"),maxSize=params.getAll("max_sqft");function rp_archive_prop_constructPriceSlider(){var e=document.getElementById("rp-archive-prop-price-range"),t=document.getElementById("rp_properties_max_rent").value;rent_range.min[0];if(0!==maxRent.length&&""!==maxRent[0]&&0==filterCount)var r=maxRent;else if(t)r=t;else r=rent_range.max[0];return noUiSlider.create(e,{start:r,connect:[!0,!1],tooltips:!0,step:10,range:{min:10*Math.ceil(Number(rent_range.min[0])/10),max:10*Math.ceil(Number(rent_range.max[0])/10)},format:{to:function(e){return 10*Math.floor(Number(e)/10)},from:function(e){return e.replace(",-","")}}}),e.noUiSlider.on("update",(function(e,r){t.value=e})),e}function setFilters(){if(selectedFilters={size:[],pet:[],type:[]},0!==beds.length&&""!==beds[0]&&0==filterCount)for(selectedFilters.size=beds,bedInputs=document.getElementsByClassName("prop-bed-filter"),e=0;bedInputs.length>e;e++)for(b=0;beds.length>b;b++)bedInputs[e].value==beds[b]&&(bedInputs[e].checked=!0);if(0!==pets.length&&""!==pets[0]&&0==filterCount)for(selectedFilters.pet=pets,petInputs=document.getElementsByClassName("prop-pet-filter"),e=0;petInputs.length>e;e++)for(p=0;pets.length>p;p++)petInputs[e].value==pets[p]&&(petInputs[e].checked=!0);if(0!==types.length&&""!==types[0]&&0==filterCount)for(selectedFilters.type=types,typeInputs=document.getElementsByClassName("prop-type-filter"),e=0;typeInputs.length>e;e++)for(p=0;types.length>p;p++)typeInputs[e].value==types[p]&&(typeInputs[e].checked=!0);if(0!==filterCount){currentFilters=document.getElementsByClassName("is-filter");for(var e=0;e<currentFilters.length;e++)if(currentFilters[e].checked)switch(currentFilters[e].parentNode.id){case"rp-archive-prop-bed-filter":selectedFilters.size.push(currentFilters[e].value);break;case"rp-archive-prop-pet-filter":selectedFilters.pet.push(currentFilters[e].value);break;case"rp-archive-prop-type-filter":selectedFilters.type.push(currentFilters[e].value)}}for(0!==term.length&&""!==term[0]&&0==filterCount?(searchTerm=term[0],document.getElementById("rp-prop-search-field").value=searchTerm):searchTerm=document.getElementById("rp-prop-search-field").value,0!==minSize.length&&""!==minSize[0]&&0==filterCount?(minSqft=minSize[0],document.getElementById("sqft-min").value=minSqft):minSqft=document.getElementById("sqft-min").value,0!==maxSize.length&&""!==maxSize[0]&&0==filterCount?(maxSqft=maxSize[0],document.getElementById("sqft-max").value=maxSqft):maxSqft=document.getElementById("sqft-max").value,z=document.getElementById("rp-archive-prop-price-range").innerText,selected_price_max=z,paramStr="?",paramStr+="search="+searchTerm,paramStr+="&max_price="+selected_price_max,e=0;selectedFilters.size.length>e;e++)paramStr+="&beds="+selectedFilters.size[e];for(e=0;selectedFilters.pet.length>e;e++)paramStr+="&pets="+selectedFilters.pet[e];for(minSqft&&""!==minSqft&&(paramStr+="&min_sqft="+minSqft),maxSqft&&""!==maxSqft&&(paramStr+="&max_sqft="+maxSqft),e=0;selectedFilters.type.length>e;e++)paramStr+="&types="+selectedFilters.type[e];newUrl=encodeURI(location.origin+location.pathname+paramStr),window.history.replaceState({},document.title,newUrl),searchTerm=document.getElementById("rp-prop-search-field").value,maxSqft=document.getElementById("sqft-max").value,minSqft=document.getElementById("sqft-min").value,filterCount++,displayPropertiesSection(),changeImagesSize(!1)}function resetFilters(){searchTerm=document.getElementById("rp-prop-search-field").value,maxSqft=document.getElementById("sqft-max").value,minSqft=document.getElementById("sqft-min").value,selectedFilters={size:[],pet:[],type:[]},currentFilters=document.getElementsByClassName("is-filter");for(var e=0;e<currentFilters.length;e++)currentFilters[e].checked=!1;document.getElementById("rp-prop-search-field").value="",document.getElementById("sqft-min").value="",document.getElementById("sqft-max").value=""}function displayPropertiesSection(e){if(propertiesCount=0,propstr="",propertiesInMap=[],void 0!==e)for(var t=[],r=e.length-1;r>=0;r--){var p=e[r];t.push(p.title)}for(r=0;r<properties.length;r++)if(void 0!==e){var s=properties[r];t.includes(s.propName[0])&&(propertiesCount++,createPropertyCard(s),propertiesInMap.push(s))}else isPropertyFilteredOut(properties[r])||(propertiesCount++,propertiesInMap.push(properties[r]),(propertiesCount<=property_load_limit||showAllProps)&&createPropertyCard(properties[r]));0==propertiesCount&&rp_archive_fp_makeNoFloorplansMessage(),document.getElementById("property_cards").innerHTML=propstr,document.getElementById("properties-count").innerHTML=propertiesCount,propertiesCount>property_load_limit&&!showAllProps?document.getElementById("properties-count-limit").innerHTML="1-"+property_load_limit+" of":document.getElementById("properties-count-limit").innerHTML="",propertiesCount>property_load_limit?showAllButton.style.display="block":showAllButton.style.display="none",initializeMap()}function rp_archive_fp_makeNoFloorplansMessage(){propstr+="<div class='rp-no-results-wrapper'>",propstr+="<p class='rp-primary-accent'>No Apartments Found</p>",propstr+="<p>Please try another search or <a class='rp-primary-accent' href='"+location.origin+"/contact'>Contact Us</a>.</p>",propstr+="</div>"}function sortProps(){var e=[],t=[],r=properties;switch(document.getElementById("property_sort").value){case"avail:asc":properties.sort((e,t)=>parseInt(e.propUnitsAvailable[0])<parseInt(t.propUnitsAvailable[0])?1:-1);break;case"price:asc":properties.sort((e,t)=>parseInt(e.wpPropMinRent[0])>parseInt(t.wpPropMinRent[0])?1:-1);break;case"price:desc":properties.sort((e,t)=>parseInt(e.wpPropMaxRent[0])<parseInt(t.wpPropMaxRent[0])?1:-1);break;case"prop:a-z":properties.sort((e,t)=>e.propName[0]>t.propName[0]?1:-1);break;case"city:a-z":properties.sort((e,t)=>e.propCity[0]>t.propCity[0]?1:-1);break;case"specials:first":for(var p=0;p<r.length;p++)prop=r[p],prop.prop_special_text[0]&&""!==prop.prop_special_text[0]?e.push(prop):t.push(prop);t.sort((e,t)=>parseInt(e.wpPropMinRent[0])>parseInt(t.wpPropMinRent[0])?1:-1),properties=e.concat(t)}setFilters()}function isPropertyFilteredOut(e){if(isFilteredOut=!1,matchedFiltersCount=0,requiredFiltersCount=0,selectedFilters.size.length>0||selectedFilters.pet.length>0||selectedFilters.type.length>0||selected_price_min!=rent_range.min[0]||selected_price_max!=rent_range.max[0]||""!=searchTerm||""!=selectedSqftMin||""!=selectedSqftMax){if(selected_price_min==rent_range.min[0]&&selected_price_max==rent_range.max[0]||(requiredFiltersCount++,fallsWithinPriceRange(e)&&matchedFiltersCount++),selectedFilters.size.length>0&&requiredFiltersCount==matchedFiltersCount){requiredFiltersCount++;for(var t=0;t<selectedFilters.size.length;t++)if(fallsWithinBedRange(selectedFilters.size[t],e)){matchedFiltersCount++;break}}if(selectedFilters.pet.length>0&&requiredFiltersCount==matchedFiltersCount){requiredFiltersCount=selectedFilters.pet.length+requiredFiltersCount;for(t=0;t<selectedFilters.pet.length;t++)meetsPetFilterCriteria(selectedFilters.pet[t],e)&&matchedFiltersCount++}if(selectedFilters.type.length>0&&requiredFiltersCount==matchedFiltersCount){requiredFiltersCount=selectedFilters.type.length+requiredFiltersCount;for(t=0;t<selectedFilters.type.length;t++)if(meetsTypeFilterCriteria(selectedFilters.type[t],e)&&1==isInRange)return void matchedFiltersCount++}if(""!=searchTerm&&requiredFiltersCount==matchedFiltersCount&&(requiredFiltersCount++,propContainsSearchTerm(e)&&matchedFiltersCount++),""!=minSqft&&(requiredFiltersCount++,fallsWithinMinSqftRange(e)&&matchedFiltersCount++),""!=maxSqft&&(requiredFiltersCount++,fallsWithinMaxSqftRange(e)&&matchedFiltersCount++),selectedFilters.type.length>0&&requiredFiltersCount==matchedFiltersCount){requiredFiltersCount=selectedFilters.type.length+requiredFiltersCount;for(t=0;t<selectedFilters.type.length;t++)if(meetsTypeFilterCriteria(selectedFilters.type[t],e)&&1==isInRange)return void matchedFiltersCount++}requiredFiltersCount!=matchedFiltersCount&&(isFilteredOut=!0)}return isFilteredOut}function propContainsSearchTerm(e){if(containsTerm=!1,0!=e.propType)for(var t=0;e.propType.length>t;t++)if(void 0!==e.propType[t]&&e.propType[t].toUpperCase().indexOf(searchTerm.toUpperCase())>-1)return containsTerm=!0,containsTerm;return(void 0!==e.propName[0]&&e.propName[0].toUpperCase().indexOf(searchTerm.toUpperCase())>-1||void 0!==e.propAddress[0]&&e.propAddress[0].toUpperCase().indexOf(searchTerm.toUpperCase())>-1||void 0!==e.propCity[0]&&e.propCity[0].toUpperCase().indexOf(searchTerm.toUpperCase())>-1||void 0!==e.propState[0]&&e.propState[0].toUpperCase().indexOf(searchTerm.toUpperCase())>-1||void 0!==e.propStateSearch&&e.propStateSearch.toUpperCase().indexOf(searchTerm.toUpperCase())>-1||void 0!==e.propZip[0]&&e.propZip[0].toUpperCase().indexOf(searchTerm.toUpperCase())>-1||void 0!==e.property_searchterms&&e.property_searchterms[0].toUpperCase().indexOf(searchTerm.toUpperCase())>-1)&&(containsTerm=!0),containsTerm}function propContainsAmenity(e){if(containsTerm=!1,e.amenities_obj)for(var t=e.amenities_obj.length-1;t>=0;t--)amenity=e.amenities_obj[t],amenity.name.toUpperCase().indexOf(searchTerm.toUpperCase())>-1&&(containsTerm=!0);return containsTerm}function fallsWithinPriceRange(e){return isInRange=!1,Number(e.wpPropMinRent[0])<=Number(selected_price_max)&&Number(e.wpPropMaxRent[0])>=Number(selected_price_min)&&(isInRange=!0),isInRange}function fallsWithinMinSqftRange(e){return isInRange=!1,Number(e.wpPropMinSQFT[0])>=Number(minSqft)&&(isInRange=!0),isInRange}function fallsWithinMaxSqftRange(e){return isInRange=!1,Number(e.wpPropMaxSQFT[0])<=Number(maxSqft)&&(isInRange=!0),isInRange}function fallsWithinBedRange(e,t){return propBeds=t.propBedsList[0],propBeds.includes(e)}function meetsPetFilterCriteria(e,t){switch(isInRange=!1,e){case"Dog Friendly":void 0!==taxonomies["Dog Friendly"]&&taxonomies["Dog Friendly"].associated_properties.indexOf(t.post_ID)>-1&&(isInRange=!0);break;case"Cat Friendly":void 0!==taxonomies["Cat Friendly"]&&taxonomies["Cat Friendly"].associated_properties.indexOf(t.post_ID)>-1&&(isInRange=!0)}return isInRange}function meetsTypeFilterCriteria(e,t){return isInRange=!1,t.propType.length>0&&t.propType.includes(e)&&(isInRange=!0),isInRange}function createPropertyCard(e){if(e.wpPropMinBeds[0]==e.wpPropMaxBeds[0]?"0"==e.wpPropMinBeds[0]?bedstr="Studio":bedstr=e.wpPropMinBeds[0]+" Bed":"0"==e.wpPropMinBeds[0]?bedstr="Studio - "+e.wpPropMaxBeds[0]+" Bed":bedstr=e.wpPropMinBeds[0]+" Bed - "+e.wpPropMaxBeds[0]+" Bed",void 0!==taxonomies["Dog Friendly"]&&taxonomies["Dog Friendly"].associated_properties.indexOf(e.post_ID)>-1?dogstr='<div class="rp-dog-icon"><span class="rp-visually-hidden">Dog is OK</span></div>':dogstr="",void 0!==taxonomies["Cat Friendly"]&&taxonomies["Cat Friendly"].associated_properties.indexOf(e.post_ID)>-1?catstr='<div class="rp-cat-icon"><span class="rp-visually-hidden">Cat is OK</span></div>':catstr="",specialText=e.prop_special_text,specialExpiration=e.prop_special_expiration,specialText&&""!=specialText&&1!=e.specialIsExpired?propSpecial='<div class="rp-prop-is-special"><h6><span>&#x2605</span> Special</h6><aside class="rp-prop-is-special-msg">'+specialText+"</aside></div>":propSpecial="",pricestr="$"+e.wpPropMinRent[0]+" - $"+e.wpPropMaxRent[0],""==e.wpPropMinRent[0]||"0"==e.wpPropMinRent[0]?pricestr="Call For Pricing":e.wpPropMaxRent[0]==e.wpPropMinRent[0]&&(pricestr="$"+e.wpPropMinRent[0]),propstr+='<div class="is-rp-prop">',propstr+='<a href="'+e.url+'" >',propstr+='<figure class="rp-prop-figure">',propstr+='<img class="rp-prop-image rp-lazy" ',e.imageSizes)for(var t=e.imageSizes.length-1;t>=0;t--)image=e.imageSizes[t],propstr+="data-"+image.size+'="'+image.url+","+image.width+","+image.height+'" ';else propstr+='data-src="'+e.image+'"';propstr+=">",propstr+=propSpecial,propstr+="</figure>",propstr+='<footer class="rp-prop-details">',propstr+='<div class="rp-prop-top">',propstr+='<h4 class="rp-primary-accent rp-prop-name">',propstr+=e.propName[0],propstr+="</h4>",propstr+='<p class="rp-prop-location">'+e.propCity[0]+", "+e.propState[0]+"</p>",propstr+="</div>",propstr+='<div class="rp-prop-bottom">',propstr+='<div class="rp-prop-bed-count"><span>'+bedstr+"</span></div>",propstr+=e.displayPrice,propstr+='<div class="rp-pets-welcome">',propstr+=catstr,propstr+=dogstr,propstr+="</div></div></footer></a></div>"}function isEnterButton(e){13==e.keyCode&&setFilters()}function createMapPropCards(e){e.wpPropMinBeds[0]==e.wpPropMaxBeds[0]?"0"==e.wpPropMinBeds[0]?bedstr="Studio":bedstr=e.wpPropMinBeds[0]+" Bed":"0"==e.wpPropMinBeds[0]?bedstr="Studio - "+e.wpPropMaxBeds[0]+" Bed":bedstr=e.wpPropMinBeds[0]+" Bed - "+e.wpPropMaxBeds[0]+" Bed",void 0!==taxonomies["Dog Friendly"]&&taxonomies["Dog Friendly"].associated_properties.indexOf(e.post_ID)>-1?dogstr='<div class="rp-dog-icon"><span class="rp-visually-hidden">Dog is OK</span></div>':dogstr="",void 0!==taxonomies["Cat Friendly"]&&taxonomies["Cat Friendly"].associated_properties.indexOf(e.post_ID)>-1?catstr='<div class="rp-cat-icon"><span class="rp-visually-hidden">Cat is OK</span></div>':catstr="",specialText=e.prop_special_text,specialExpiration=e.prop_special_expiration,specialText&&""!=specialText&&1!=e.specialIsExpired?propSpecial='<div class="rp-prop-is-special"><h6><span>&#x2605</span> Special</h6><aside class="rp-prop-is-special-msg">'+specialText+"</aside></div>":propSpecial="",pricestr="$"+e.wpPropMinRent[0]+" - $"+e.wpPropMaxRent[0],""==e.wpPropMinRent[0]||"0"==e.wpPropMinRent[0]?pricestr="Call For Pricing":e.wpPropMaxRent[0]==e.wpPropMinRent[0]&&(pricestr="$"+e.wpPropMinRent[0]);var t="";return t+='<div class="is-rp-prop">',t+='<a href="'+e.url+'" >',t+='<figure class="rp-prop-figure">',t+='<img class="rp-prop-image" ',t+='src="'+e.image+'"',t+=">",t+=propSpecial,t+="</figure>",t+='<footer class="rp-prop-details">',t+='<div class="rp-prop-top">',t+='<h4 class="rp-primary-accent rp-prop-name">',t+=e.propName[0],t+="</h4>",t+='<p class="rp-prop-location">'+e.propCity[0]+", "+e.propState[0]+"</p>",t+="</div>",t+='<div class="rp-prop-bottom">',t+='<div class="rp-prop-bed-count"><span>'+bedstr+"</span></div>",t+=e.displayPrice,t+='<div class="rp-pets-welcome">',t+=catstr,t+=dogstr,t+="</div></div></footer></a></div>"}function filterByMap(e){for(var t=[],r=e.length-1;r>=0;r--){var p=e[r];t.push(p.title)}for(r=properties.length-1;r>=0;r--){var s=properties[r];t.includes(s.propName[0])&&createPropertyCard(s)}}function initializeMap(){map=new google.maps.Map(document.getElementById("rp-search-map"),{zoom:6,mapTypeId:google.maps.MapTypeId.ROADMAP});bounds=new google.maps.LatLngBounds,markers=[];for(var e=0;e<propertiesInMap.length;e++)if(prop=propertiesInMap[e],prop.propLatitude[0]&&prop.propLongitude[0]){var t={path:"M 25, 50 a 25,25 0 1,1 50,0 a 25,25 0 1,1 -50,0",fillColor:accentColor,fillOpacity:1,scale:.5,strokeColor:"white",strokeWeight:.5,anchor:new google.maps.Point(45,65)};marker=new google.maps.Marker({position:new google.maps.LatLng(prop.propLatitude[0],prop.propLongitude[0]),icon:t,title:prop.propName[0]});createMapPropCards(prop);var r=!1;infowindow=new google.maps.InfoWindow({content:createMapPropCards(prop)}),google.maps.event.addListener(marker,"click",function(e,t,p){return function(){r&&r.close(),r=p,p.open(map,e)}}(marker,0,infowindow)),bounds.extend(marker.position),markers.push(marker),changeImagesSize(!1),rpLazyLoad()}cluster_grid=15,min_cluster=3,clusterGridSize&&(cluster_grid=clusterGridSize),minClusterSize&&(min_cluster=minClusterSize),map.fitBounds(bounds);var p,s,i,n,o={styles:[{textColor:"white",width:78,height:78,url:(p="heart",s=100,i=100,n=accentColor,"data:image/svg+xml;base64,"+window.btoa('<svg xmlns="http://www.w3.org/2000/svg" height="'+i+'" viewBox="0 0 512 512" width="'+s+'" ><g><path stroke="'+n+'" stroke-width="80" stroke-opacity="0.7" fill="'+n+'" d="'+{heart:{p:"M 100, 200 a 100,100 0 1,1 200,0 a 100,100 0 1,1 -200,0"}}[p].p+'" /></g></svg>'))}],minimumClusterSize:min_cluster,gridSize:cluster_grid,anchor:new google.maps.Point(100,65)},a=new MarkerClusterer(map,markers,o);google.maps.event.addListener(a,"clusterclick",(function(e){displayPropertiesSection(e.getMarkers())}))}function filterToggle(){dropdowns=document.getElementsByClassName("filter-dropdown");for(let e=dropdowns.length-1;e>=0;e--){let t=dropdowns[e];document.addEventListener("click",(function(e){t.contains(e.target)||"block"!=t.children[1].style.display||(t.children[1].style.display="none")})),t.children[0].addEventListener("click",(function(){t.children[1].style.display="block"}),!1),t.children[1].children[t.children.length-1].addEventListener("click",(function(){t.children[1].style.display="none"}),!1)}}document.addEventListener("DOMContentLoaded",(function(){1!=rent_range.max[0]&&rent_range.max[0]!=rent_range.min[0]&&(window.price_range_slider=rp_archive_prop_constructPriceSlider()),sortProps()}),!1),currentFilters=document.getElementsByClassName("is-filter"),showAllButton.addEventListener("click",(function(){"Show All"==showAllButton.innerHTML?(showAllProps=!0,showAllButton.innerHTML="Show Fewer",setFilters()):"Show Fewer"==showAllButton.innerHTML&&(showAllProps=!1,showAllButton.innerHTML="Show All",setFilters())})),window.onkeyup=function(e){isEnterButton(e)},document.getElementById("rp-prop-search-button").addEventListener("click",(function(){setFilters()})),document.getElementById("rp-archive-fp-open-mobile-open-filters").onclick=function(){document.getElementById("rp-archive-fp-sidebar").classList.toggle("rp-is-mobile-open")},filterToggle();
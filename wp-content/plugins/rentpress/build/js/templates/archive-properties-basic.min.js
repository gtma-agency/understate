var rent_range=scriptVars.rent_range,taxonomies=scriptVars.taxonomies,properties=scriptVars.properties,property_load_limit=scriptVars.property_load_limit,selected_price_min=0,selected_price_max=0,searchTerm="",showAllProps=!1,filterCount=0,showAllButton=document.getElementById("rp-prop-load-more-btn"),selectedFilters={size:[],pet:[],type:[]};params=new URLSearchParams(location.search);var maxRent=params.getAll("max_price"),beds=params.getAll("beds"),pets=params.getAll("pets"),types=params.getAll("types"),term=params.getAll("search");function rp_archive_prop_constructPriceSlider(){var e=document.getElementById("rp-archive-prop-price-range"),r=document.getElementById("rp_properties_max_rent").value;rent_range.min[0];if(0!==maxRent.length&&""!==maxRent[0]&&0==filterCount)var t=maxRent;else if(r)t=r;else t=rent_range.max[0];return noUiSlider.create(e,{start:t,connect:[!0,!1],tooltips:!0,step:10,range:{min:10*Math.ceil(Number(rent_range.min[0])/10),max:10*Math.ceil(Number(rent_range.max[0])/10)},format:{to:function(e){return 10*Math.floor(Number(e)/10)},from:function(e){return e.replace(",-","")}}}),e.noUiSlider.on("update",(function(e,t){r.value=e})),e}function setFilters(){if(selectedFilters={size:[],pet:[],type:[]},0!==beds.length&&""!==beds[0]&&0==filterCount)for(selectedFilters.size=beds,bedInputs=document.getElementsByClassName("prop-bed-filter"),e=0;bedInputs.length>e;e++)for(b=0;beds.length>b;b++)bedInputs[e].value==beds[b]&&(bedInputs[e].checked=!0);if(0!==pets.length&&""!==pets[0]&&0==filterCount)for(selectedFilters.pet=pets,petInputs=document.getElementsByClassName("prop-pet-filter"),e=0;petInputs.length>e;e++)for(p=0;pets.length>p;p++)petInputs[e].value==pets[p]&&(petInputs[e].checked=!0);if(0!==types.length&&""!==types[0]&&0==filterCount)for(selectedFilters.type=types,typeInputs=document.getElementsByClassName("prop-type-filter"),e=0;typeInputs.length>e;e++)for(p=0;types.length>p;p++)typeInputs[e].value==types[p]&&(typeInputs[e].checked=!0);if(0!==filterCount){currentFilters=document.getElementsByClassName("is-filter");for(var e=0;e<currentFilters.length;e++)if(currentFilters[e].checked)switch(currentFilters[e].parentNode.id){case"rp-archive-prop-bed-filter":selectedFilters.size.push(currentFilters[e].value);break;case"rp-archive-prop-pet-filter":selectedFilters.pet.push(currentFilters[e].value);break;case"rp-archive-prop-type-filter":selectedFilters.type.push(currentFilters[e].value)}}for(0!==term.length&&""!==term[0]&&0==filterCount?(searchTerm=term[0],document.getElementById("rp-prop-search-field").value=searchTerm):searchTerm=document.getElementById("rp-prop-search-field").value,z=document.getElementById("rp-archive-prop-price-range").innerText,selected_price_max=z,paramStr="?",paramStr+="search="+searchTerm,paramStr+="&max_price="+selected_price_max,e=0;selectedFilters.size.length>e;e++)paramStr+="&beds="+selectedFilters.size[e];for(e=0;selectedFilters.pet.length>e;e++)paramStr+="&pets="+selectedFilters.pet[e];for(e=0;selectedFilters.type.length>e;e++)paramStr+="&types="+selectedFilters.type[e];newUrl=encodeURI(location.origin+location.pathname+paramStr),window.history.replaceState({},document.title,newUrl),filterCount++,displayPropertiesSection(),changeImagesSize(!1)}function resetFilters(){selectedFilters={size:[],pet:[],type:[]},currentFilters=document.getElementsByClassName("is-filter");for(var e=0;e<currentFilters.length;e++)currentFilters[e].checked=!1;displayPropertiesSection()}function displayPropertiesSection(){propertiesCount=0,propstr="";for(var e=0;e<properties.length;e++)isPropertyFilteredOut(properties[e])||(propertiesCount++,(propertiesCount<=property_load_limit||showAllProps)&&createPropertyCard(properties[e]));0==propertiesCount&&rp_archive_fp_makeNoFloorplansMessage(),document.getElementById("property_cards").innerHTML=propstr,document.getElementById("properties-count").innerHTML=propertiesCount,propertiesCount>property_load_limit&&!showAllProps?document.getElementById("properties-count-limit").innerHTML="1-"+property_load_limit+" of":document.getElementById("properties-count-limit").innerHTML="",propertiesCount>property_load_limit?showAllButton.style.display="block":showAllButton.style.display="none"}function rp_archive_fp_makeNoFloorplansMessage(){propstr+="<div class='rp-no-results-wrapper'>",propstr+="<p class='rp-primary-accent'>No Apartments Found</p>",propstr+="<p>Please try another search or <a class='rp-primary-accent' href='"+location.origin+"/contact'>Contact Us</a>.</p>",propstr+="</div>"}function sortProps(){var e=[],r=[],t=properties;switch(document.getElementById("property_sort").value){case"avail:asc":properties.sort((e,r)=>parseInt(e.propUnitsAvailable[0])<parseInt(r.propUnitsAvailable[0])?1:-1);break;case"price:asc":properties.sort((e,r)=>parseInt(e.wpPropMinRent[0])>parseInt(r.wpPropMinRent[0])?1:-1);break;case"price:desc":properties.sort((e,r)=>parseInt(e.wpPropMaxRent[0])<parseInt(r.wpPropMaxRent[0])?1:-1);break;case"prop:a-z":properties.sort((e,r)=>e.propName[0]>r.propName[0]?1:-1);break;case"city:a-z":properties.sort((e,r)=>e.propCity[0]>r.propCity[0]?1:-1);break;case"specials:first":for(var p=0;p<t.length;p++)prop=t[p],prop.prop_special_text[0]&&""!==prop.prop_special_text[0]?e.push(prop):r.push(prop);r.sort((e,r)=>parseInt(e.wpPropMinRent[0])>parseInt(r.wpPropMinRent[0])?1:-1),properties=e.concat(r)}setFilters()}function isPropertyFilteredOut(e){if(isFilteredOut=!1,matchedFiltersCount=0,requiredFiltersCount=0,selectedFilters.size.length>0||selectedFilters.pet.length>0||selectedFilters.type.length>0||selected_price_min!=rent_range.min[0]||selected_price_max!=rent_range.max[0]||""!=searchTerm){if(selected_price_min==rent_range.min[0]&&selected_price_max==rent_range.max[0]||(requiredFiltersCount++,fallsWithinPriceRange(e)&&matchedFiltersCount++),selectedFilters.size.length>0&&requiredFiltersCount==matchedFiltersCount){requiredFiltersCount++;for(var r=0;r<selectedFilters.size.length;r++)if(fallsWithinBedRange(selectedFilters.size[r],e)){matchedFiltersCount++;break}}if(selectedFilters.pet.length>0&&requiredFiltersCount==matchedFiltersCount){requiredFiltersCount=selectedFilters.pet.length+requiredFiltersCount;for(r=0;r<selectedFilters.pet.length;r++)meetsPetFilterCriteria(selectedFilters.pet[r],e)&&matchedFiltersCount++}if(""!=searchTerm&&requiredFiltersCount==matchedFiltersCount&&(requiredFiltersCount++,propContainsSearchTerm(e)&&matchedFiltersCount++),selectedFilters.type.length>0&&requiredFiltersCount==matchedFiltersCount){requiredFiltersCount=selectedFilters.type.length+requiredFiltersCount;for(r=0;r<selectedFilters.type.length;r++)if(meetsTypeFilterCriteria(selectedFilters.type[r],e)&&1==isInRange)return void matchedFiltersCount++}requiredFiltersCount!=matchedFiltersCount&&(isFilteredOut=!0)}return isFilteredOut}function propContainsSearchTerm(e){if(containsTerm=!1,0!=e.propType)for(var r=0;e.propType.length>r;r++)if(void 0!==e.propType[r]&&e.propType[r].toUpperCase().indexOf(searchTerm.toUpperCase())>-1)return containsTerm=!0,containsTerm;return(void 0!==e.propName[0]&&e.propName[0].toUpperCase().indexOf(searchTerm.toUpperCase())>-1||void 0!==e.propAddress[0]&&e.propAddress[0].toUpperCase().indexOf(searchTerm.toUpperCase())>-1||void 0!==e.propCity[0]&&e.propCity[0].toUpperCase().indexOf(searchTerm.toUpperCase())>-1||void 0!==e.propState[0]&&e.propState[0].toUpperCase().indexOf(searchTerm.toUpperCase())>-1||void 0!==e.propStateSearch&&e.propStateSearch.toUpperCase().indexOf(searchTerm.toUpperCase())>-1||void 0!==e.propZip[0]&&e.propZip[0].toUpperCase().indexOf(searchTerm.toUpperCase())>-1||void 0!==e.property_searchterms&&e.property_searchterms[0].toUpperCase().indexOf(searchTerm.toUpperCase())>-1)&&(containsTerm=!0),containsTerm}function fallsWithinPriceRange(e){return isInRange=!1,Number(e.wpPropMinRent[0])<=Number(selected_price_max)&&Number(e.wpPropMaxRent[0])>=Number(selected_price_min)&&(isInRange=!0),isInRange}function fallsWithinBedRange(e,r){return propBeds=r.propBedsList[0],propBeds.includes(e)}function meetsPetFilterCriteria(e,r){switch(isInRange=!1,e){case"Dog Friendly":void 0!==taxonomies["Dog Friendly"]&&taxonomies["Dog Friendly"].associated_properties.indexOf(r.post_ID)>-1&&(isInRange=!0);break;case"Cat Friendly":void 0!==taxonomies["Cat Friendly"]&&taxonomies["Cat Friendly"].associated_properties.indexOf(r.post_ID)>-1&&(isInRange=!0)}return isInRange}function meetsTypeFilterCriteria(e,r){return isInRange=!1,r.propType.length>0&&r.propType.includes(e)&&(isInRange=!0),isInRange}function createPropertyCard(e){if(e.wpPropMinBeds[0]==e.wpPropMaxBeds[0]?"0"==e.wpPropMinBeds[0]?bedstr="Studio":bedstr=e.wpPropMinBeds[0]+" Bed":"0"==e.wpPropMinBeds[0]?bedstr="Studio - "+e.wpPropMaxBeds[0]+" Bed":bedstr=e.wpPropMinBeds[0]+" Bed - "+e.wpPropMaxBeds[0]+" Bed",void 0!==taxonomies["Dog Friendly"]&&taxonomies["Dog Friendly"].associated_properties.indexOf(e.post_ID)>-1?dogstr='<div class="rp-dog-icon"><span class="rp-visually-hidden">Dog is OK</span></div>':dogstr="",void 0!==taxonomies["Cat Friendly"]&&taxonomies["Cat Friendly"].associated_properties.indexOf(e.post_ID)>-1?catstr='<div class="rp-cat-icon"><span class="rp-visually-hidden">Cat is OK</span></div>':catstr="",specialText=e.prop_special_text,specialExpiration=e.prop_special_expiration,specialText&&""!=specialText&&1!=e.specialIsExpired?propSpecial='<div class="rp-prop-is-special"><h6><span>&#x2605</span> Special</h6><aside class="rp-prop-is-special-msg">'+specialText+"</aside></div>":propSpecial="",pricestr="$"+e.wpPropMinRent[0]+" - $"+e.wpPropMaxRent[0],""==e.wpPropMinRent[0]||"0"==e.wpPropMinRent[0]?pricestr="Call For Pricing":e.wpPropMaxRent[0]==e.wpPropMinRent[0]&&(pricestr="$"+e.wpPropMinRent[0]),propstr+='<div class="is-rp-prop">',propstr+='<a href="'+e.url+'" >',propstr+='<figure class="rp-prop-figure">',propstr+='<img class="rp-prop-image rp-lazy" ',e.imageSizes)for(var r=e.imageSizes.length-1;r>=0;r--)image=e.imageSizes[r],propstr+="data-"+image.size+'="'+image.url+","+image.width+","+image.height+'" ';else propstr+='src="'+e.image+'"';propstr+=">",propstr+=propSpecial,propstr+="</figure>",propstr+='<footer class="rp-prop-details">',propstr+='<div class="rp-prop-top">',propstr+='<h4 class="rp-primary-accent rp-prop-name">',propstr+=e.propName[0],propstr+="</h4>",propstr+='<p class="rp-prop-location">'+e.propCity[0]+", "+e.propState[0]+"</p>",propstr+="</div>",propstr+='<div class="rp-prop-bottom">',propstr+='<div class="rp-prop-bed-count"><span>'+bedstr+"</span></div>",propstr+=e.displayPrice,propstr+='<div class="rp-pets-welcome">',propstr+=catstr,propstr+=dogstr,propstr+="</div></div></footer></a></div>"}function isEnterButton(e){13==e.keyCode&&(setFilters(),"function"==typeof propSearchEvent&&propSearchEvent())}document.addEventListener("DOMContentLoaded",(function(){1!=rent_range.max[0]&&rent_range.max[0]!=rent_range.min[0]&&(window.price_range_slider=rp_archive_prop_constructPriceSlider()),sortProps()}),!1),currentFilters=document.getElementsByClassName("is-filter"),showAllButton.addEventListener("click",(function(){"Show All"==showAllButton.innerHTML?(showAllProps=!0,showAllButton.innerHTML="Show Fewer",setFilters()):"Show Fewer"==showAllButton.innerHTML&&(showAllProps=!1,showAllButton.innerHTML="Show All",setFilters())})),window.onkeyup=function(e){isEnterButton(e)},document.getElementById("rp-prop-search-button").addEventListener("click",(function(){setFilters()})),document.getElementById("rp-archive-fp-open-mobile-open-filters").onclick=function(){document.getElementById("rp-archive-fp-sidebar").classList.toggle("rp-is-mobile-open")};